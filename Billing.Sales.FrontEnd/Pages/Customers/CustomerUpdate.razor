@page "/customers/update/{id:int}"
@using Billing.Sales.FrontEnd.Models
@using Billing.Sales.FrontEnd.Services
@using Microsoft.AspNetCore.Components.Forms
@inject CustomerService customerService
@inject NavigationManager nav

<h3>Actualizar Cliente</h3>

@if (model == null)
{
    <p>Cargando...</p>
}
else
{
    <EditForm Model="model" OnValidSubmit="Save">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="mb-2">
            <label>Cédula</label>
            <InputText class="form-control" @bind-Value="model.IdentificationNumber" />
        </div>

        <div class="mb-2">
            <label>Nombre</label>
            <InputText class="form-control" @bind-Value="model.FirstName" />
        </div>

        <button class="btn btn-success">Actualizar</button>
    </EditForm>
}

@code {
    [Parameter] public int id { get; set; }

    CustomerModel model;

    protected override async Task OnInitializedAsync()
    {
        model = await customerService.GetByIdAsync(id);
    }

    async Task Save()
    {
        await customerService.UpdateAsync(model);
        nav.NavigateTo("/customers");
    }
}
